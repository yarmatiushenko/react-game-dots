(this.webpackJsonpstartnavi=this.webpackJsonpstartnavi||[]).push([[0],{22:function(e,a,r){e.exports=r(37)},31:function(e,a,r){},33:function(e,a,r){},34:function(e,a,r){},35:function(e,a,r){},36:function(e,a,r){},37:function(e,a,r){"use strict";r.r(a);var n=r(0),t=r.n(n),s=r(7),o=r.n(s),i=r(9),c=r(5),u=r(1),l={loading:!1,winners:[],userName:"",userMode:"",delay:"",userNameError:"",userModeError:"",gameWinner:"",endGame:!1,startGame:!1,arrayGameField:[],gameSetting:[],gameMode:[],error:null};var d,m=r(13),p=r(17);Object(p.createLogger)();d=Object(c.a)(m.a);var E=Object(c.c)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"FETCH_LOADER":return Object(u.a)({},e,{loading:!0});case"FETCH_SETTING_SUCCESS":return Object(u.a)({},e,{gameSetting:a.payload,gameMode:a.payload});case"FETCH_WINNERS_SUCCESS":return Object(u.a)({},e,{loading:!1,winners:a.payload});case"SET_USER_NAME":return Object(u.a)({},e,{userName:a.payload,userNameError:""});case"SET_USER_NAME_ERROR":return Object(u.a)({},e,{userNameError:a.payload});case"SET_USER_MODE_ERROR":return Object(u.a)({},e,{userModeError:a.payload});case"SET_USER_MODE":var r=e.gameSetting.findIndex((function(e){return e.field===+a.payload})),n=e.gameSetting[r].delay;return Object(u.a)({},e,{userMode:a.payload,delay:n,userModeError:""});case"START_USER_GAME":return Object(u.a)({},e,{endGame:!1,startGame:!0,gameWinner:"",arrayGameField:e.arrayGameField.map((function(e){return 0===e.status?e:Object(u.a)({},e,{status:0})}))});case"END_USER_GAME":return Object(u.a)({},e,{startGame:!1,endGame:!0,gameWinner:a.payload});case"ADD_ELEMENT_FIELD":return Object(u.a)({},e,{arrayGameField:a.payload});case"CHANGE_ELEMENT_STATUS":return Object(u.a)({},e,{arrayGameField:e.arrayGameField.map((function(e){return e.id===a.idx?Object(u.a)({},e,{status:a.status}):e}))});case"FETCH_ERROR":return Object(u.a)({},e,{loading:!1,error:a.payload});default:return e}}),d),f=r(8),g=r(18),h=r(20),v=r(19),y=r(21),N=(r(31),r(3)),S=r.n(N),_=r(6),M=new function e(){var a=this;Object(f.a)(this,e),this._apiBase="https://starnavi-frontend-test-task.herokuapp.com",this.getResource=function(){var e=Object(_.a)(S.a.mark((function e(r){var n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(a._apiBase).concat(r));case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("Could not fetch ".concat(a._apiBase).concat(r,", received ").concat(n.status));case 5:return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),this.setResources=function(){var e=Object(_.a)(S.a.mark((function e(r,n){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(a._apiBase).concat(r),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("Could not fetch ".concat(a._apiBase).concat(r,", received ").concat(t.status));case 5:return e.next=7,t.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(a,r){return e.apply(this,arguments)}}(),this.getGameSetting=Object(_.a)(S.a.mark((function e(){var r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getResource("/game-settings");case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)}))),this.setGameWinners=function(){var e=Object(_.a)(S.a.mark((function e(r){var n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setResources("/winners",r);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),this.getGameWinners=Object(_.a)(S.a.mark((function e(){var r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getResource("/winners");case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})))},b=function(){return{type:"FETCH_LOADER"}},G=function(e){return{type:"FETCH_WINNERS_SUCCESS",payload:e}},w=function(e){return{type:"SET_USER_MODE",payload:e}},O=function(e){for(var a=[],r=0;r<Math.pow(e,2);r++)a.push({id:r,status:0});return{type:"ADD_ELEMENT_FIELD",payload:a}};function R(e){return{type:"FETCH_ERROR",error:e}}r(33);var C=function(e){var a=e.gameMode,r=e.userMode,n=e.userName,s=e.userModeError,o=e.userNameError,i=e.handleSubmit,c=e.startGame,u=e.endGame,l=e.handleChangeMode,d=e.handleChangeName;return t.a.createElement("div",null,t.a.createElement("form",{onSubmit:i},t.a.createElement("div",{className:"form-mode"},t.a.createElement("div",{className:"form-mode__group"},t.a.createElement("select",{onChange:l,value:r,disabled:c?"disabled":""},t.a.createElement("option",{value:""},"Pick game mode"),a.map((function(e){return t.a.createElement("option",{value:e.field,key:e.id},e.mode)}))),s?t.a.createElement("span",{className:"form-error"},s):""),t.a.createElement("div",{className:"form-mode__group"},t.a.createElement("input",{type:"text",placeholder:"Enter your name",value:n,disabled:c?"disabled":"",onChange:d}),o?t.a.createElement("span",{className:"form-error"},o):""),t.a.createElement("div",{className:"form-mode__group"},t.a.createElement("button",{disabled:c?"disabled":""},u?"Play again":"Play")))))},T=(r(34),r(2)),j=r.n(T),U=(r(35),function(){return t.a.createElement("div",{className:"loader"},t.a.createElement("div",{className:"inner one"}),t.a.createElement("div",{className:"inner two"}),t.a.createElement("div",{className:"inner three"}))}),k=(r(36),function(e){var a=e.winners,r=e.loading;return t.a.createElement("div",{className:"winner-wrapper"},t.a.createElement("h2",null,"Leader Board"),r?t.a.createElement(U,null):a.map((function(e){return t.a.createElement("div",{key:e.id,className:"winners"},t.a.createElement("div",{className:"winners-item"},e.winner),t.a.createElement("div",{className:"winners-item"},e.date))})))}),W=function(e){var a=e.arrayGameField,r=e.userMode,n=e.gameWinner,s=e.handleClick;return t.a.createElement("div",{className:"game-wrapper"},t.a.createElement("h4",{className:"game-winner"},n?"".concat(n," won!"):""),t.a.createElement("div",{className:"game-area",style:{maxWidth:"".concat(50*r,"px")}},a.map((function(e){return t.a.createElement("div",{style:{background:2===e.status?"#00E871":1===e.status?"#42D8E8":3===e.status?"#E85A5F":"#fff"},className:"game-area-item",key:e.id,onClick:function(){return s(e.id,e.status)}})}))))};k.propTypes={arrayGameField:j.a.array,handleClick:j.a.func,gameWinner:j.a.string};var F=function(e){function a(){var e,r;Object(f.a)(this,a);for(var n=arguments.length,t=new Array(n),s=0;s<n;s++)t[s]=arguments[s];return(r=Object(h.a)(this,(e=Object(v.a)(a)).call.apply(e,[this].concat(t)))).handleChangeName=function(e){var a=e.target.value;r.props.setUserName(a)},r.handleChangeMode=function(e){var a=e.target.value;r.props.setUserMode(a)},r.handleClick=function(e,a){var n=r.props.arrayGameField;if(1===a){var t=n.findIndex((function(a){return a.id===e}));r.props.changeElementStatus(t,2)}},r.handleSubmit=function(e){e.preventDefault();var a=r.props,n=a.userName,t=a.userMode;return""===n?(r.props.setUserNameError("Invalid user name"),!1):""===t?(r.props.setUserModeError("Invalid user mode"),!1):(r.props.startUserGame(),void r.interval())},r.sendUserWinners=function(e){r.props.endUserGame(e),r.props.setWinners(r.sendData())},r.sendData=function(){var e=r.props.gameWinner,a=new Date,n=a.toLocaleString("default",{month:"long"});return{winner:e,date:"".concat(a.toTimeString().slice(0,5)," ").concat(a.getDate()," ").concat(n,"  ").concat(a.getFullYear())}},r.interval=function(){var e=setInterval((function(){var a=r.props.arrayGameField,n=a.filter((function(e){return 0===e.status})),t=a.filter((function(e){return 1===e.status})),s=a.filter((function(e){return 2===e.status})),o=a.filter((function(e){return 3===e.status}));if(s.length>a.length/2)return clearInterval(e),r.sendUserWinners(r.props.userName),!1;if(o.length>a.length/2)return clearInterval(e),r.sendUserWinners("Computer"),!1;if(t.length){var i=t.findIndex((function(e){return 1===e.status})),c=t[i].id,u=a.findIndex((function(e){return e.id===c}));r.props.changeElementStatus(u,3)}else if(n.length){var l=n[Math.floor(Math.random()*n.length)].id,d=a.findIndex((function(e){return e.id===l}));r.props.changeElementStatus(d,1)}else clearInterval(e)}),r.props.delay)},r}return Object(y.a)(a,e),Object(g.a)(a,[{key:"componentDidMount",value:function(){this.props.getGameMode(),this.props.getWinners()}},{key:"render",value:function(){var e=this.props,a=e.loading,r=e.gameMode,n=e.userMode,s=e.userName,o=e.userNameError,i=e.userModeError,c=e.arrayGameField,u=e.getWinners,l=e.startGame,d=e.winners,m=e.gameWinner,p=e.endGame;return t.a.createElement("div",{className:"container"},t.a.createElement("h1",null,"Game In Dots"),t.a.createElement("div",{className:"wrapper-area"},t.a.createElement("div",null,t.a.createElement(C,{gameMode:r,userName:s,userMode:n,userNameError:o,userModeError:i,handleSubmit:this.handleSubmit,startGame:l,endGame:p,handleChangeName:this.handleChangeName,handleChangeMode:this.handleChangeMode}),t.a.createElement(W,{arrayGameField:c,handleClick:this.handleClick,userMode:n,gameWinner:m})),t.a.createElement(k,{getWinners:u,winners:d,loading:a})))}}]),a}(t.a.Component);var x={getGameMode:function(){return function(e){M.getGameSetting().then((function(a){var r=Object.values(function(e){var a=0;for(var r in e)e[r].mode=r,e[r].id=a++;return e}(a));e({type:"FETCH_SETTING_SUCCESS",payload:r})}),(function(a){e(R(a))}))}},getWinners:function(){return function(e){e(b()),M.getGameWinners().then((function(a){e(G(a))}),(function(a){e(R(a))}))}},setUserName:function(e){return{type:"SET_USER_NAME",payload:e}},setUserMode:function(e){return function(a){a(w(e)),a(O(e))}},setUserModeError:function(e){return{type:"SET_USER_MODE_ERROR",payload:e}},setUserNameError:function(e){return{type:"SET_USER_NAME_ERROR",payload:e}},startUserGame:function(){return{type:"START_USER_GAME"}},changeElementStatus:function(e,a){return{type:"CHANGE_ELEMENT_STATUS",idx:e,status:a}},endUserGame:function(e){return{type:"END_USER_GAME",payload:e}},setWinners:function(e){return function(a){a(b()),M.setGameWinners(e).then((function(e){a(G(e))}),(function(e){a(R(e))}))}}},D=Object(i.b)((function(e){var a=e.loading,r=e.gameSetting,n=e.gameMode,t=e.userSetting,s=e.userName,o=e.userMode,i=e.userModeError,c=e.userNameError,u=e.arrayGameField,l=e.startGame,d=e.winners,m=e.gameWinner,p=e.endGame;return{loading:a,gameSetting:r,delay:e.delay,gameMode:n,userSetting:t,userName:s,userMode:o,userNameError:c,userModeError:i,arrayGameField:u,startGame:l,winners:d,gameWinner:m,endGame:p}}),x)(F);var A=function(){return t.a.createElement("div",{className:"App"},t.a.createElement(D,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(t.a.createElement(i.a,{store:E},t.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[22,1,2]]]);
//# sourceMappingURL=main.e28ef9a4.chunk.js.map