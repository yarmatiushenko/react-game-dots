(this.webpackJsonpstartnavi=this.webpackJsonpstartnavi||[]).push([[0],{20:function(e,a,n){e.exports=n(36)},30:function(e,a,n){},32:function(e,a,n){},33:function(e,a,n){},34:function(e,a,n){},35:function(e,a,n){},36:function(e,a,n){"use strict";n.r(a);var t=n(0),r=n.n(t),s=n(7),o=n.n(s),i=n(9),c=n(6),u=n(1),l={loading:!1,winners:[],userName:"",userMode:"",delay:"",userNameError:"",userModeError:"",gameWinner:"",endGame:!1,startGame:!1,arrayGameField:[],gameSetting:[],gameMode:[],error:null};var d=n(15),m=Object(c.c)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"FETCH_LOADER":return Object(u.a)({},e,{loading:!0});case"FETCH_SETTING_SUCCESS":return Object(u.a)({},e,{gameSetting:a.payload,gameMode:a.payload});case"FETCH_WINNERS_SUCCESS":return Object(u.a)({},e,{loading:!1,winners:a.payload});case"SET_USER_NAME":return Object(u.a)({},e,{userName:a.payload,userNameError:""});case"SET_USER_NAME_ERROR":return Object(u.a)({},e,{userNameError:a.payload});case"SET_USER_MODE_ERROR":return Object(u.a)({},e,{userModeError:a.payload});case"SET_USER_MODE":var n=e.gameSetting.findIndex((function(e){return e.field===+a.payload})),t=e.gameSetting[n].delay;return Object(u.a)({},e,{userMode:a.payload,delay:t,userModeError:""});case"START_USER_GAME":return Object(u.a)({},e,{endGame:!1,startGame:!0,gameWinner:"",arrayGameField:e.arrayGameField.map((function(e){return 0===e.status?e:Object(u.a)({},e,{status:0})}))});case"END_USER_GAME":return Object(u.a)({},e,{startGame:!1,endGame:!0,gameWinner:a.payload});case"ADD_ELEMENT_FIELD":return Object(u.a)({},e,{arrayGameField:a.payload});case"CHANGE_ELEMENT_STATUS":return Object(u.a)({},e,{arrayGameField:e.arrayGameField.map((function(e){return e.id===a.idx?Object(u.a)({},e,{status:a.status}):e}))});case"FETCH_ERROR":return Object(u.a)({},e,{loading:!1,error:a.payload});default:return e}}),Object(c.a)(d.a)),p=n(8),E=n(16),f=n(18),g=n(17),h=n(19),v=(n(30),n(2)),y=n.n(v),N=n(5),S=new function e(){var a=this;Object(p.a)(this,e),this._apiBase="https://starnavi-frontend-test-task.herokuapp.com",this.getResource=function(){var e=Object(N.a)(y.a.mark((function e(n){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(a._apiBase).concat(n));case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("Could not fetch ".concat(a._apiBase).concat(n,", received ").concat(t.status));case 5:return e.next=7,t.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),this.setResources=function(){var e=Object(N.a)(y.a.mark((function e(n,t){var r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(a._apiBase).concat(n),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:if((r=e.sent).ok){e.next=5;break}throw new Error("Could not fetch ".concat(a._apiBase).concat(n,", received ").concat(r.status));case 5:return e.next=7,r.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(a,n){return e.apply(this,arguments)}}(),this.getGameSetting=Object(N.a)(y.a.mark((function e(){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getResource("/game-settings");case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)}))),this.setGameWinners=function(){var e=Object(N.a)(y.a.mark((function e(n){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setResources("/winners",n);case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),this.getGameWinners=Object(N.a)(y.a.mark((function e(){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getResource("/winners");case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))},_=function(){return{type:"FETCH_LOADER"}},M=function(e){return{type:"FETCH_WINNERS_SUCCESS",payload:e}},b=function(e){return{type:"SET_USER_MODE",payload:e}},G=function(e){for(var a=[],n=0;n<Math.pow(e,2);n++)a.push({id:n,status:0});return{type:"ADD_ELEMENT_FIELD",payload:a}};function w(e){return{type:"FETCH_ERROR",error:e}}n(32);var O=function(e){var a=e.gameMode,n=e.userMode,t=e.userName,s=e.userModeError,o=e.userNameError,i=e.handleSubmit,c=e.startGame,u=e.endGame,l=e.handleChangeMode,d=e.handleChangeName;return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:i},r.a.createElement("div",{className:"form-mode"},r.a.createElement("div",{className:"form-mode__group"},r.a.createElement("select",{onChange:l,value:n,disabled:c?"disabled":""},r.a.createElement("option",{value:""},"Pick game mode"),a.map((function(e,a){return r.a.createElement("option",{value:e.field,key:a},e.mode)}))),s?r.a.createElement("span",{className:"form-error"},s):""),r.a.createElement("div",{className:"form-mode__group"},r.a.createElement("input",{type:"text",placeholder:"Enter your name",value:t,disabled:c?"disabled":"",onChange:d}),o?r.a.createElement("span",{className:"form-error"},o):""),r.a.createElement("div",{className:"form-mode__group"},r.a.createElement("button",{disabled:c?"disabled":""},u?"Play again":"Play")))))},R=(n(33),function(e){var a=e.arrayGameField,n=e.userMode,t=e.gameWinner,s=e.handleClick;return r.a.createElement("div",{className:"game-wrapper"},r.a.createElement("h4",{className:"game-winner"},t?"".concat(t," won!"):""),r.a.createElement("div",{className:"game-area",style:{maxWidth:"".concat(50*n,"px")}},a.map((function(e){return r.a.createElement("div",{style:{background:2===e.status?"#00E871":1===e.status?"#42D8E8":3===e.status?"#E85A5F":"#fff"},className:"game-area-item",key:e.id,onClick:function(){return s(e.id,e.status)}})}))))}),C=(n(34),function(){return r.a.createElement("div",{className:"loader"},r.a.createElement("div",{className:"inner one"}),r.a.createElement("div",{className:"inner two"}),r.a.createElement("div",{className:"inner three"}))}),T=(n(35),function(e){var a=e.winners,n=e.loading;return r.a.createElement("div",{className:"winner-wrapper"},r.a.createElement("h2",null,"Leader Board"),n?r.a.createElement(C,null):a.map((function(e){return r.a.createElement("div",{key:e.id,className:"winners"},r.a.createElement("div",{className:"winners-item"},e.winner),r.a.createElement("div",{className:"winners-item"},e.date))})))}),U=function(e){function a(){var e,n;Object(p.a)(this,a);for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return(n=Object(f.a)(this,(e=Object(g.a)(a)).call.apply(e,[this].concat(r)))).handleChangeName=function(e){var a=e.target.value;n.props.setUserName(a)},n.handleChangeMode=function(e){var a=e.target.value;n.props.setUserMode(a)},n.handleClick=function(e,a){var t=n.props.arrayGameField;if(1===a){var r=t.findIndex((function(a){return a.id===e}));n.props.changeElementStatus(r,2)}},n.handleSubmit=function(e){e.preventDefault();var a=n.props,t=a.userName,r=a.userMode;return""===t?(n.props.setUserNameError("Invalid user name"),!1):""===r?(n.props.setUserModeError("Invalid user mode"),!1):(n.props.startUserGame(),void n.interval())},n.sendUserWinners=function(e){n.props.endUserGame(e),n.props.setWinners(n.sendData())},n.sendData=function(){var e=n.props.gameWinner,a=new Date,t=a.toLocaleString("default",{month:"long"});return{winner:e,date:"".concat(a.toTimeString().slice(0,5)," ").concat(a.getDate()," ").concat(t,"  ").concat(a.getFullYear())}},n.interval=function(){var e=setInterval((function(){var a=n.props.arrayGameField,t=a.filter((function(e){return 0===e.status})),r=a.filter((function(e){return 1===e.status})),s=a.filter((function(e){return 2===e.status})),o=a.filter((function(e){return 3===e.status}));if(s.length>a.length/2)return clearInterval(e),n.sendUserWinners(n.props.userName),!1;if(o.length>a.length/2)return clearInterval(e),n.sendUserWinners("Computer"),!1;if(r.length){var i=r.findIndex((function(e){return 1===e.status})),c=r[i].id,u=a.findIndex((function(e){return e.id===c}));n.props.changeElementStatus(u,3)}else if(t.length){var l=t[Math.floor(Math.random()*t.length)].id,d=a.findIndex((function(e){return e.id===l}));n.props.changeElementStatus(d,1)}else clearInterval(e)}),n.props.delay)},n}return Object(h.a)(a,e),Object(E.a)(a,[{key:"componentDidMount",value:function(){this.props.getGameMode(),this.props.getWinners()}},{key:"render",value:function(){var e=this.props,a=e.loading,n=e.gameMode,t=e.userMode,s=e.userName,o=e.userNameError,i=e.userModeError,c=e.arrayGameField,u=e.getWinners,l=e.startGame,d=e.winners,m=e.gameWinner,p=e.endGame;return r.a.createElement("div",{className:"container"},r.a.createElement("h1",null,"Game In Dots"),r.a.createElement("div",{className:"wrapper-area"},r.a.createElement("div",null,r.a.createElement(O,{gameMode:n,userName:s,userMode:t,userNameError:o,userModeError:i,handleSubmit:this.handleSubmit,startGame:l,endGame:p,handleChangeName:this.handleChangeName,handleChangeMode:this.handleChangeMode}),r.a.createElement(R,{arrayGameField:c,handleClick:this.handleClick,userMode:t,gameWinner:m})),r.a.createElement(T,{getWinners:u,winners:d,loading:a})))}}]),a}(r.a.Component);var j={getGameMode:function(){return function(e){S.getGameSetting().then((function(a){var n=Object.values(function(e){for(var a in e)e[a].mode=a;return e}(a));e({type:"FETCH_SETTING_SUCCESS",payload:n})}),(function(a){e(w(a))}))}},getWinners:function(){return function(e){e(_()),S.getGameWinners().then((function(a){e(M(a))}),(function(a){e(w(a))}))}},setUserName:function(e){return{type:"SET_USER_NAME",payload:e}},setUserMode:function(e){return function(a){a(b(e)),a(G(e))}},setUserModeError:function(e){return{type:"SET_USER_MODE_ERROR",payload:e}},setUserNameError:function(e){return{type:"SET_USER_NAME_ERROR",payload:e}},startUserGame:function(){return{type:"START_USER_GAME"}},changeElementStatus:function(e,a){return{type:"CHANGE_ELEMENT_STATUS",idx:e,status:a}},endUserGame:function(e){return{type:"END_USER_GAME",payload:e}},setWinners:function(e){return function(a){a(_()),S.setGameWinners(e).then((function(e){a(M(e))}),(function(e){a(w(e))}))}}},k=Object(i.b)((function(e){var a=e.loading,n=e.gameSetting,t=e.gameMode,r=e.userSetting,s=e.userName,o=e.userMode,i=e.userModeError,c=e.userNameError,u=e.arrayGameField,l=e.startGame,d=e.winners,m=e.gameWinner,p=e.endGame;return{loading:a,gameSetting:n,delay:e.delay,gameMode:t,userSetting:r,userName:s,userMode:o,userNameError:c,userModeError:i,arrayGameField:u,startGame:l,winners:d,gameWinner:m,endGame:p}}),j)(U);var W=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(k,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(i.a,{store:m},r.a.createElement(W,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[20,1,2]]]);
//# sourceMappingURL=main.94d2a4cd.chunk.js.map